# X5.RetailHero.ai Uplift Modelling
Решение для ML соревнования по Uplift Modelling
##Public Leadboard: 0,0955
##Описание подхода
Всего фич: 139. Все фичи сконструированы, как более-менее "осмысленные", имеющие понятный смысл в реальном мире. Вначале проводится небольшой data cleansing.

Для построения моделей используется Catboost и LGBM. В данном случае Catboost показывает немного лучшие результаты.

Реализовано три подхода:
..* 2 независимые модели
..* Многоклассовая модель (4 модели для предсказания 4-х классов)
..* Модель с трансформацией классов

Про все эти подходы и многое другое есть две отличные статьи на Хабре: [здесь](https://habr.com/ru/company/ru_mts/blog/485980/) и [здесь](https://habr.com/ru/company/ru_mts/blog/485976/).
В данном случае **трансформация классов** показывает наилучший результат.

##Описание кода
Весь код в одном ноутбуке. Постарался сделать легко читаемым, иногда в ущерб краткости. Для всех функций есть комментарии, так же, как и в неочевидных (для меня) местах.

Вначале выполняется генерирование фич, дальше можно запускать отдельные куски кода для разных моделей или изучения фич. Можно легко добавлять/менять фичи и смотреть, что меняется. Для новичков должно хорошо зайти.

##Как запускать
Скачать данные соревнования, распаковать в папку data\
Запустить ноутбук в jupyter.

##Результаты
Код запускался на Windows 10. 
Время генерации фич - около 15 минут. Время обучения модели - несколько минут, но это с использованием GPU.

Public score: 0,0955, получен на catboost модели трансформации классов.
Перебор разных фич и параметров моделей очень слабо влияет на локальную кросс-валидацию, но может сильно изменить public score.

##Ссылки
Данный ноутбук использует код из [scikit-uplift module](https://github.com/maks-sh/scikit-uplift/) by Maksim Shevchenko


